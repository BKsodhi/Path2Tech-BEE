<% title = subject + " - " + type + " (" + difficulty + ")" %>

<style>
  /* Theme variables */
  :root {
      --primary-charcoal: #1C232B;
      --primary-dark: #12181F;
      --accent-neon: #00FFD1;
      --success-color: #A3FF00;
      --text-color: #E5E7EB;
      --text-muted-dark: #7B8A99;
      --text-dark: #000000;
      --card-bg: var(--primary-charcoal);
  }

  .container { color: var(--text-color); }

  /* Page header */
  .main-header h2 {
      color: var(--primary-charcoal);
      letter-spacing: 1px;
      text-transform: uppercase;
  }
  .main-header p {
      color: var(--primary-charcoal);
      opacity: 0.8;
      text-shadow: 0 0 2px rgba(0, 255, 209, 0.4);
      margin-top: -5px;
      margin-bottom: 2rem;
  }

  /* Difficulty tabs styling */
  .nav-tabs { border-bottom: 2px solid var(--accent-neon); }
  .nav-tabs .nav-item { margin: 0 10px; }
  .nav-tabs .nav-link {
      color: var(--accent-neon);
      background-color: var(--primary-dark);
      border: 1px solid var(--accent-neon);
      border-bottom: none;
      box-shadow: 0 0 5px rgba(0, 255, 209, 0.3);
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 0.5rem 1.2rem;
  }
  .nav-tabs .nav-link:hover {
      background-color: var(--primary-charcoal);
      color: var(--text-color);
  }
  .nav-tabs .nav-link.active {
      color: var(--text-dark) !important;
      background-color: var(--accent-neon);
      border-color: var(--accent-neon) !important;
      font-weight: 700;
      box-shadow: 0 0 15px var(--accent-neon);
      transform: translateY(-4px);
  }

  /* Question card styling */
  .question-card {
      background-color: var(--card-bg);
      border: 2px solid var(--primary-dark);
      border-left: 6px solid var(--accent-neon);
      border-radius: 8px;
      box-shadow: 0 0 18px rgba(0, 255, 209, 0.5);
      transition: box-shadow 0.3s, transform 0.3s;
  }
  .question-card:hover {
      transform: scale(1.005);
      box-shadow: 0 0 30px rgba(0, 255, 209, 0.8);
  }
  .question-card h5 {
      color: var(--text-color);
      border-bottom: 1px solid rgba(0, 255, 209, 0.2);
      padding-bottom: 10px;
      margin-bottom: 15px;
  }

  /* Bookmark icon */
  .bookmark { color: var(--accent-neon) !important; filter: opacity(0.5); }
  .bi-star-fill {
      color: var(--success-color) !important;
      filter: drop-shadow(0 0 5px var(--success-color));
  }

  /* Radio option styling */
  .form-check { margin-bottom: 0.5rem; padding-left: 0; }
  .form-check-label {
      color: var(--text-color);
      background-color: var(--primary-dark);
      border: 1px solid var(--primary-charcoal);
      border-radius: 4px;
      padding: 0.75rem 1rem 0.75rem 3rem;
      display: block;
      width: 100%;
      transition: all 0.2s;
      position: relative;
  }
  .form-check-input {
      position: absolute;
      opacity: 0;
      cursor: pointer;
  }
  .form-check-label::before {
      content: '>';
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--accent-neon);
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      transition: all 0.2s;
  }
  .form-check-input:checked + .form-check-label {
      color: var(--success-color);
      font-weight: 600;
      background-color: #0F1A1B;
      border-color: var(--success-color);
      box-shadow: 0 0 10px rgba(163, 255, 0, 0.5);
  }
  .form-check-input:checked + .form-check-label::before {
      content: 'âœ“';
      color: var(--success-color);
      text-shadow: 0 0 5px var(--success-color);
  }

  /* Submit button */
  .btn-submit {
      background-color: var(--accent-neon);
      border-color: var(--accent-neon);
      color: var(--text-dark);
      padding: 1rem 4rem;
      font-weight: 800;
      border-radius: 6px;
      box-shadow: 0 0 40px rgba(0, 255, 209, 0.8);
      text-transform: uppercase;
      letter-spacing: 2px;
      font-size: 1.1rem;
  }
  .btn-submit:hover {
      background-color: #00E3BB;
      border-color: #00E3BB;
      transform: translateY(-4px);
      box-shadow: 0 0 60px rgba(0, 255, 209, 1);
  }
</style>

<!-- Page Container -->
<div class="container my-5">
  
  <!-- Page Header -->
  <div class="text-center mb-5 main-header">
    <h2 class="fw-bold"><%= subject %> - <%= type %> (<%= difficulty %>)</h2>
    <p>Path2Tech >> Running Test Suite >> <%= subject %>/<%= difficulty %></p>
  </div>

  <!-- Difficulty Tabs -->
  <% const difficulties = ["Easy", "Medium", "Hard"]; %>
  <ul class="nav nav-tabs mb-5 justify-content-center">
    <% difficulties.forEach(diff => { %>
      <li class="nav-item">
        <a class="nav-link <%= diff === difficulty ? 'active' : '' %>" 
           href="/modules/<%= subject %>/MCQ/<%= diff %>"><%= diff %></a>
      </li>
    <% }) %>
  </ul>

  <!-- MCQ Form -->
  <form id="mcqForm" action="/modules/<%= subject %>/<%= type %>/<%= difficulty %>" method="POST">
    
    <% questions.forEach((q, index) => { %>
      <!-- MCQ Card -->
      <div class="card shadow-sm mb-4 position-relative question-card">
        <div class="card-body">

          <!-- Question & Bookmark -->
          <div class="d-flex justify-content-between align-items-start mb-3">
            <h5 class="fw-bold">Q<%= index + 1 %>. <%= q.question %></h5>
            <i class="bi bi-star fs-4 bookmark" 
               style="cursor:pointer;" 
               data-question-id="<%= q.id %>"></i>
          </div>

          <!-- Options -->
          <% q.options.forEach((opt, i) => { %>
            <div class="form-check">
              <input class="form-check-input" type="radio" 
                     name="q<%= q.id %>" 
                     value="<%= opt %>" 
                     id="q<%= q.id %>opt<%= i %>">
              <label class="form-check-label" for="q<%= q.id %>opt<%= i %>">
                <%= opt %>
              </label>
            </div>
          <% }) %>
        </div>
      </div>
    <% }) %>

    <!-- Submit Button -->
    <div class="text-center my-5">
      <button type="submit" class="btn btn-submit">
          <i class="bi bi-cpu me-2"></i> Execute Submission
      </button>
    </div>

  </form>
</div>

<script>
  // Toggle bookmark icon
  document.querySelectorAll('.bookmark').forEach(star => {
    star.addEventListener('click', () => {
      star.classList.toggle('bi-star');
      star.classList.toggle('bi-star-fill');
      const qId = star.dataset.questionId;
      console.log("Toggled bookmark for question:", qId);
    });
  });
</script>

<%
    title = "Admin - Users"
    currentPath = "/admin/users"
%>

<style>
/* Reusing Admin styles for consistency */
:root {
    --primary-charcoal: #1C232B;
    --primary-dark: #12181F;
    --accent-neon: #00FFD1;
    --text-color: #F5F7FA;
    --pass-color: #A3FF00; /* Lime for Pass/Complete */
    --fail-color: #FF0066; /* Red for Fail/Incomplete (used for delete button in this context) */
}

.admin-header {
    color: var(--accent-neon);
    text-shadow: 0 0 10px rgba(0, 255, 209, 0.4);
    letter-spacing: 2px;
    margin-bottom: 30px;
    text-transform: uppercase;
}

/* TABLE STYLING */
.table-console {
    background-color: var(--primary-dark); 
    color: var(--text-color);
    border: 1px solid var(--primary-charcoal); 
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6);
}
/* Table Header */
.table-console thead th {
    background-color: var(--primary-charcoal);
    color: var(--accent-neon);
    border-bottom: 3px solid var(--accent-neon); 
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}
/* Table Body */
.table-console tbody td {
    border-top: 1px dashed var(--primary-charcoal); 
    border-bottom: none;
    padding: 12px 10px;
}

/* Table Striping and Hover */
.table-console tbody tr:nth-of-type(odd) {
    background-color: var(--primary-dark);
}
.table-console tbody tr:nth-of-type(even) {
    background-color: var(--primary-charcoal);
}
.table-console tbody tr:hover {
    background-color: #283743 !important;
}

/* Action Button Styling */
.table-console .btn-danger {
    background-color: var(--fail-color);
    border-color: var(--fail-color);
    box-shadow: 0 0 8px rgba(255, 0, 102, 0.5);
    transition: all 0.2s;
}
.table-console .btn-danger:hover {
    background-color: #E3005A;
    border-color: #E3005A;
    transform: scale(1.05);
}

/* Status Indicators (optional, but good for 'Role' column if needed) */
.status-admin {
    color: var(--pass-color);
    font-weight: 700;
    text-shadow: 0 0 5px rgba(163, 255, 0, 0.5);
}
.status-user {
    color: var(--accent-neon);
    font-weight: 600;
}
</style>

<div class="container my-5">

<h2 class="admin-header"><i class="bi bi-people-fill me-2"></i> Registered Users</h2>

<div class="table-responsive">
<table class="table table-console">
    <thead>
        <tr>
            <th>User ID</th>
            <th>Username</th>
            <th>Email</th>
            <th>Role</th>
            <th>Created At</th>
            <th>Action</th>
        </tr>
    </thead>

    <tbody>
        <% if (users.length > 0) { %>
            <% users.forEach(u => { %>
                <tr>
                    <td><%= u.id %></td>
                    <td><%= u.username %></td>
                    <td><%= u.email %></td>
                    <% // Apply conditional styling based on user role (assuming 'role' or 'is_admin' is available) %>
                    <td class="<%= u.role && u.role.toLowerCase() === 'admin' ? 'status-admin' : 'status-user' %>">
                        <%= u.role %>
                    </td>
                    <td><%= new Date(u.created_at).toLocaleString() %></td>
                    <td>
                        <form action="/admin/users/delete/<%= u.id %>" method="POST" 
                              onsubmit="return confirm('Delete this user? All progress will also be removed.');">
                            <button class="btn btn-danger btn-sm">
                                <i class="bi bi-trash-fill"></i>
                            </button>
                        </form>
                    </td>
                </tr>
            <% }) %>
        <% } else { %>
            <tr>
                <td colspan="6" class="text-center" style="color: var(--accent-neon);">
                    <i class="bi bi-info-circle me-2"></i> No users found.
                </td>
            </tr>
        <% } %>
    </tbody>
</table>
</div>

</div>